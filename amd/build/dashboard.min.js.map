{"version":3,"file":"dashboard.min.js","sources":["../src/dashboard.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript controller for controlling the sections.\n *\n * @module     block_dashboard/dashboard\n * @package    blocks\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n// jshint unused: true, undef:false\n// global dhtmlXCalendarObject\n/* eslint-disable no-undef */\ndefine(['jquery', 'core/log'], function ($, log) {\n\n    return {\n\n        init: function() {\n\n            var that = this;\n\n            that.calendars = [];\n\n            var lang = $('html').attr('lang').replace(/-/g, '_').substr(0, 2);\n\n            // Attach filter handles if autosubmit.\n            $('.dashboard-filter-autosubmit').each( function() {\n                var regex = /dashboard-auto-([0-9]+)/;\n                var matchs = regex.exec($(this).attr('id'));\n                var blockid = matchs[1];\n\n                $('.dashboard-filter-element-' + blockid).on('change', that.submitdashboardfilter);\n            });\n\n            $('.dashboard-filter-submitters').each( function() {\n                $(this).on('click', that.submitdashboardfilter);\n            });\n\n            // Capture all data params and attach a dhtmlxCalendar.\n            $('.dashboard-param-date').each(function() {\n                var id = $(this).attr('id');\n                that.calendars[id] = new dhtmlXCalendarObject(id);\n                that.calendars[id].loadUserLanguage(lang + '_utf8');\n                that.calendars[id].setSkin('dhx_web');\n            });\n\n            $('.dashboard-param-daterange').each(function() {\n                var id = $(this).attr('id');\n                id = id.replace('_from', '');\n                that.calendars[id] = new dhtmlXCalendarObject([id + '_from', id + '_to']);\n                that.calendars[id].loadUserLanguage(lang + '_utf8');\n                that.calendars[id].setSkin('dhx_web');\n            });\n\n            log.debug('Block dashboard AMD initialized');\n\n        },\n\n        submitdashboardfilter: function submitdashboardfilter() {\n\n            // That is the Jquery representant of the changed form element.\n            var that = $(this);\n            var regex = /(?:filter|filtersubmit)([0-9]+)_/;\n            var matchs = regex.exec(that.attr('name'));\n\n            if (matchs) {\n                var blockid = matchs[1];\n                $('#dashboard-form-' + blockid).submit();\n            }\n        }\n    };\n});"],"names":["define","$","log","init","that","this","calendars","lang","attr","replace","substr","each","blockid","exec","on","submitdashboardfilter","id","dhtmlXCalendarObject","loadUserLanguage","setSkin","debug","matchs","submit"],"mappings":";;;;;;;AAyBAA,mCAAO,CAAC,SAAU,aAAa,SAAUC,EAAGC,WAEjC,CAEHC,KAAM,eAEEC,KAAOC,KAEXD,KAAKE,UAAY,OAEbC,KAAON,EAAE,QAAQO,KAAK,QAAQC,QAAQ,KAAM,KAAKC,OAAO,EAAG,GAG/DT,EAAE,gCAAgCU,MAAM,eAGhCC,QAFQ,0BACOC,KAAKZ,EAAEI,MAAMG,KAAK,OAChB,GAErBP,EAAE,6BAA+BW,SAASE,GAAG,SAAUV,KAAKW,0BAGhEd,EAAE,gCAAgCU,MAAM,WACpCV,EAAEI,MAAMS,GAAG,QAASV,KAAKW,0BAI7Bd,EAAE,yBAAyBU,MAAK,eACxBK,GAAKf,EAAEI,MAAMG,KAAK,MACtBJ,KAAKE,UAAUU,IAAM,IAAIC,qBAAqBD,IAC9CZ,KAAKE,UAAUU,IAAIE,iBAAiBX,KAAO,SAC3CH,KAAKE,UAAUU,IAAIG,QAAQ,cAG/BlB,EAAE,8BAA8BU,MAAK,eAC7BK,GAAKf,EAAEI,MAAMG,KAAK,MACtBQ,GAAKA,GAAGP,QAAQ,QAAS,IACzBL,KAAKE,UAAUU,IAAM,IAAIC,qBAAqB,CAACD,GAAK,QAASA,GAAK,QAClEZ,KAAKE,UAAUU,IAAIE,iBAAiBX,KAAO,SAC3CH,KAAKE,UAAUU,IAAIG,QAAQ,cAG/BjB,IAAIkB,MAAM,oCAIdL,sBAAuB,eAGfX,KAAOH,EAAEI,MAETgB,OADQ,mCACOR,KAAKT,KAAKI,KAAK,YAE9Ba,OAAQ,KACJT,QAAUS,OAAO,GACrBpB,EAAE,mBAAqBW,SAASU,WAI/C"}